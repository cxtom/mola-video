{"version":3,"sources":["Video.js"],"names":["Video","args","state","start","onClick","bind","onPlay","onEnd","componentDidMount","props","videoType","refs","video","playsInline","setAttribute","setState","renderRaw","autoPlay","title","src","poster","renderIframe","render","className","style","top","left","width","height","act","backgroundImage","propTypes","oneofType","number","string","isRequired","oneOf","bool","defaultProps"],"mappings":"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","file":"Video.js","sourcesContent":["/**\n * @file 视频组件\n * @author cxtom <cxtom2008@gmail.com>\n */\n\nimport React, {Component, PropTypes} from 'react';\nimport {registerComponent, px2rem} from 'mola';\nimport {type, level} from './constants';\nimport cx from 'classnames';\n\nexport class Video extends Component {\n\n    constructor(...args) {\n        super(...args);\n        this.state = {\n            start: false\n        };\n        this.onClick = this.onClick.bind(this);\n        this.onPlay = this.onPlay.bind(this);\n        this.onEnd = this.onEnd.bind(this);\n    }\n\n    componentDidMount() {\n        if (this.props.videoType === 'raw' && this.refs.video && this.props.playsInline) {\n            this.refs.video.setAttribute('webkit-playsinline', 'webkit-playsinline');\n            this.refs.video.setAttribute('playsinline', 'playsinline');\n        }\n    }\n\n    onPlay() {\n        this.setState({start: true});\n    }\n\n    onEnd() {\n        this.setState({start: false});\n    }\n\n    onClick() {\n        const start = this.state.start;\n        const video = this.refs.video;\n        video[start ? 'pause' : 'play']();\n    }\n\n    renderRaw() {\n\n        const {autoPlay, title} = this.props;\n\n        return (\n            <video\n                src={this.props.src}\n                poster={this.props.poster}\n                className=\"mola-video-raw\"\n                onPlay={this.onPlay}\n                onPause={this.onEnd}\n                onEnded={this.onEnd}\n                title={title}\n                data-type=\"btn\"\n                autoBuffer\n                controls\n                autoPlay={autoPlay}\n                preload=\"none\"\n                width=\"100%\"\n                height=\"100%\"\n                ref=\"video\" />\n        );\n    }\n\n    renderIframe() {\n\n        return (\n            <iframe\n                src={this.props.src}\n                onLoad={this.onPlay}\n                className=\"mola-video-iframe\"\n                data-type=\"btn\"\n                scrolling=\"no\"\n                frameBorder=\"0\"\n                allowFullScreen=\"true\" />\n        );\n    }\n\n    render() {\n\n        let {\n            className = null,\n            style = null,\n            videoType,\n            top,\n            left,\n            width,\n            height,\n            poster\n        } = this.props;\n\n        const start = this.state.start;\n        const act = videoType === 'iframe' ? 'iframe' : (\n            start ? 'pause' : 'play'\n        );\n\n        return (\n            <div\n                onClick={videoType === 'iframe' ? null : this.onClick}\n                dara-type=\"btn\"\n                data-click={`{\"mod\": \"video\", \"act\": \"b_${act}\"}`}\n                className={cx('mola-video', className, {'state-start': start})}\n                style={{\n                    ...style,\n                    top: px2rem(top),\n                    left: px2rem(left),\n                    width: px2rem(width),\n                    height: px2rem(height),\n                    backgroundImage: start ? 'none' : `url(${poster})`\n                }}>\n                {videoType === 'iframe' ? this.renderIframe() : this.renderRaw()}\n            </div>\n        );\n    }\n\n}\n\nVideo.propTypes = {\n    top: PropTypes.oneofType([\n        PropTypes.number,\n        PropTypes.string\n    ]).isRequired,\n    left: PropTypes.oneofType([\n        PropTypes.number,\n        PropTypes.string\n    ]).isRequired,\n    width: PropTypes.oneofType([\n        PropTypes.number,\n        PropTypes.string\n    ]).isRequired,\n    height: PropTypes.oneofType([\n        PropTypes.number,\n        PropTypes.string\n    ]).isRequired,\n    poster: PropTypes.string,\n    videoType: PropTypes.oneOf(['iframe', 'raw']),\n    src: PropTypes.string,\n    autoPlay: PropTypes.bool,\n    playsInline: PropTypes.bool,\n    title: PropTypes.string\n};\n\nVideo.defaultProps = {\n    top: 0,\n    left: 0,\n    width: 320,\n    height: 180,\n    videoType: 'iframe',\n    autoPlay: true,\n    playsInline: false\n};\n\nexport default registerComponent(type, level)(Video);\n"]}