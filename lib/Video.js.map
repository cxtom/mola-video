{"version":3,"sources":["Video.js"],"names":["type","level","Video","args","state","start","onClick","bind","onPlay","onEnd","componentDidMount","props","videoType","setState","on","refs","video","componentWillUnmount","off","play","renderRaw","src","poster","renderIframe","render","className","style","top","left","width","height","act","backgroundImage","displayName","propTypes","number","isRequired","string","oneOf","defaultProps"],"mappings":"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","file":"Video.js","sourcesContent":["/**\n * @file 视频组件\n * @author cxtom <cxtom2008@gmail.com>\n */\n\nimport React, {Component, PropTypes} from 'react';\n\nimport {\n    registerComponent,\n    MOLA_COMPONENT_LEVEL_ATOM,\n    px2rem\n} from 'mola';\n\nimport cx from 'classnames';\nimport domUtil from 'melon/common/util/dom';\n\nexport const type = 'Video';\nexport const level = MOLA_COMPONENT_LEVEL_ATOM;\n\nexport class Video extends Component {\n\n    constructor(...args) {\n        super(...args);\n        this.state = {\n            start: false\n        };\n        this.onClick = this.onClick.bind(this);\n        this.onPlay = this.onPlay.bind(this);\n        this.onEnd = this.onEnd.bind(this);\n    }\n\n    componentDidMount() {\n        if (this.props.videoType === 'iframe') {\n            this.setState({start: true});\n        }\n        else if (this.props.videoType === 'raw') {\n            domUtil.on(this.refs.video, 'play', this.onPlay);\n            domUtil.on(this.refs.video, 'ended', this.onEnd);\n            domUtil.on(this.refs.video, 'pause', this.onEnd);\n        }\n    }\n\n    componentWillUnmount() {\n        if (this.props.videoType === 'raw') {\n            domUtil.off(this.refs.video, 'play', this.onPlay);\n            domUtil.off(this.refs.video, 'ended', this.onEnd);\n            domUtil.off(this.refs.video, 'pause', this.onEnd);\n        }\n    }\n\n    onPlay() {\n        this.setState({start: true});\n    }\n\n    onEnd() {\n        this.setState({start: false});\n    }\n\n    onClick() {\n        const video = this.refs.video;\n        video.play();\n    }\n\n    renderRaw() {\n\n        return (\n            <video\n                src={this.props.src}\n                poster={this.props.poster}\n                className=\"mola-video-raw\"\n                data-type=\"btn\"\n                autoBuffer\n                autoPlay\n                preload=\"none\"\n                width=\"100%\"\n                height=\"100%\"\n                ref=\"video\" />\n        );\n    }\n\n    renderIframe() {\n\n        return (\n            <iframe\n                src={this.props.src}\n                className=\"mola-video-iframe\"\n                data-type=\"btn\"\n                scrolling=\"no\"\n                frameBorder=\"0\"\n                allowFullScreen=\"true\" />\n        );\n    }\n\n    render() {\n\n        let {\n            className = null,\n            style = null,\n            videoType,\n            top,\n            left,\n            width,\n            height,\n            poster\n        } = this.props;\n\n        const start = this.state.start;\n        const act = videoType === 'iframe' ? 'iframe' : (\n            start ? 'pause' : 'play'\n        );\n\n        return (\n            <div\n                onClick={videoType === 'iframe' ? null : this.onClick}\n                dara-type=\"btn\"\n                data-click={`{\"mod\": \"video\", \"act\": \"b_${act}\"}`}\n                className={cx('mola-video', className, {'state-start': start})}\n                style={{\n                    ...style,\n                    top: px2rem(top),\n                    left: px2rem(left),\n                    width: px2rem(width),\n                    height: px2rem(height),\n                    backgroundImage: start ? 'none' : `url(${poster})`\n                }}>\n                {videoType === 'iframe' ? this.renderIframe() : this.renderRaw()}\n            </div>\n        );\n    }\n\n}\n\nVideo.displayName = type;\n\nVideo.propTypes = {\n    top: PropTypes.number.isRequired,\n    left: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n    poster: PropTypes.string,\n    videoType: PropTypes.oneOf(['iframe', 'raw']),\n    src: PropTypes.string\n};\n\nVideo.defaultProps = {\n    top: 0,\n    left: 0,\n    width: 320,\n    height: 180,\n    videoType: 'iframe'\n};\n\nexport default registerComponent(type, level)(Video);\n"]}